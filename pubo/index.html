<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<title></title>
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<link rel="stylesheet" href="css/font-awesome.min.css" />
		<link rel="stylesheet" href="css/jquery.datetimepicker.css" />
		
		<link rel="stylesheet" href="css/main.css" />
	</head>

	<body>
		<div class="container-fluid">
			<!--顶部-->
			<div class="row top-bg">
				<div class="col-xs-12 col-sm-6 text-right">
					<span>C5-2Fs</span>
				
					<span>腹部</span>
				</div>
				<div class="col-xs-12 col-sm-3">
					2018/05/16 18：00：00
				</div>
				<div class="col-xs-12 col-sm-3">
					<div class="top-icon-list">
						<i class="fa fa-wifi"></i>
						<i class="fa fa-question-circle"></i>
						<i class="fa fa-gear"></i>
						<i class="fa fa-desktop"></i>
					</div>
				</div>
			</div>
			<!--顶部结束-->
			<div class="row">
				<div class="col-xs-12 col-sm-10">
					<!--信息面板-->
					<div class="col-sm-2 tips-pane">
						<div>&#91;B1&#93;</div>
						<div class="tips-item clearfix">
							<label for="" >频率</label><span>2.0MHz</span>
						</div>
						<div class="tips-item clearfix">
							<label for="">动态范围</label><span>30</span>
						</div>
						<div class="tips-item clearfix">
							<label for="">增益</label><span>0</span>
						</div>
						<div class="tips-item clearfix">
							<label for="">帧率</label><span>23</span>
						</div>
						<div class="tips-item clearfix">
							<label for="">深度</label><span>3.0</span>
						</div>
					</div>
					<!--信息面板结束-->
					
					<!--图像显示面板 开始-->
					<div class="col-sm-10 image-pane">
						<div class="image-header-info">
							<span class="info-1">AP10%</span>
							<span class="info-2">MI0.9TIB0.3</span>
						</div>
						<!--实时图像-->
						<div class="image-online clearfix">
							<div class="image-online-left">
								<div class="title text-center">左侧视图</div>
								<div class="content">
									<img src="images/timg.jpg" alt="" class="leftImage"/>
								</div>
							</div>
							<div class="image-online-right">
								<div class="title text-center">右侧视图</div>
								<div class="content">
									<img src="images/3.jpg" alt="" class="rightImage"/>
								</div>
							</div>
						</div>
						<!--实时图像结束-->
					</div>
					<!--图像显示面板 结束-->
				</div>
				
				<div class="col-xs-12 col-sm-2">
					<div class="right-box">
						<div class="right-title">
							缩略图	
						</div>
						<div class="right-content">
							
						</div>
						<div class="right-footer">
							<div class="text-center">
								<i class="fa fa-chevron-down fa-2x"></i>
								<i class="fa fa-chevron-up fa-2x"></i>
								<i class="fa fa-trash-o fa-2x" data-bind="click:deleteImg"></i>
								<i class="fa fa-share fa-2x"></i>
							</div>
						</div>
					</div>
				</div>
			</div>
			
			
			
			<!--按钮控制面板-->
			<div class="mune-panel">
				<ul class="nav nav-tabs">
					<li>
						<a href="#features" data-toggle="tab">功能</a>
					</li>
					<li>
						<a href="#imageMode" data-toggle="tab">图像模式</a>
					</li>
					<li>
						<a href="#B" data-toggle="tab">B</a>
					</li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane fade in active" id="features">
						<div class="btn-toolbar">
							<div class="btn-group btn-group-1" style="display: block;">
								<button class="btn btn-group-lg" type="button" data-toggle="modal" data-target="#info"><i class="fa fa-user-circle"></i><span class="title">信息</span></button>
								<button class="btn btn-group-lg" type="button" data-bind="click:save"><i class="fa fa-save"></i>保存</button>
								<button class="btn btn-group-lg" type="button">保存参数</button>
							</div>
							<div class="btn-group btn-group-2" style="display: none;">
								<button class="btn btn-group-lg" type="button"><i class="fa fa-edit"></i><span class="title">注释</span></button>
								<button class="btn btn-group-lg" type="button"><i class="fa fa-save"></i>体标</button>
								<button class="btn btn-group-lg" type="button"><i class="fa fa-list"></i>病人列表</button>
							</div>
							<div class="btn-group">
								<!--<button class="btn btn-default btn-group-lg shift" type="button">功能按钮</button>-->
								<div class="shift-btn">
									<div class="half-circle left activeBtn"></div>
									<div class="middle">F</div>
									<div class="half-circle right"></div>
								</div>
							</div>
							<div class="btn-group btn-group-1" style="display: block;">
								<button class="btn btn-group-lg" type="button">测量</button>
								<button class="btn btn-group-lg" type="button"><i class="fa fa-remove"></i>清除所有</button>
								<button class="btn btn-group-lg" type="button"><i class="fa  fa-search-plus"></i>放大</button>
							</div>
							<div class="btn-group btn-group-2" style="display: none;">
								<button class="btn btn-group-lg" type="button"><i class="fa fa-file-text"></i>报告</button>
								<button class="btn btn-group-lg" type="button"><i class="fa fa-external-link-square"></i>箭头</button>
								<button class="btn btn-group-lg" type="button"></button>
							</div>
						</div>
					</div>

					<div class="tab-pane fade" id="imageMode">
						<div class="tab-pane fade in active" id="features">
							<div class="btn-toolbar">
								<div class="btn-group">
									<button class="btn btn-group-lg" type="button"><i class=""></i>B</button>
									<button class="btn btn-group-lg" type="button"><i class="fa "></i>2B</button>
									<button class="btn btn-group-lg" type="button">B&M</button>
								</div>
								<div class="btn-group">
									<button class="btn btn-group-lg" type="button"><i class="fa fa-search"></i></button>
								</div>
								<div class="btn-group">
									<button class="btn btn-group-lg" type="button">Color</button>
									<button class="btn btn-group-lg" type="button"><i class="fa "></i>Power</button>
									<button class="btn btn-group-lg" type="button"><i class="fa "></i>PW</button>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane fade" id="B">b</div>

				</div>
			</div>
			<!--按钮控制面板 结束-->
		</div>

		<!--模态框-->
		<div class="modal fade" id="info" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog modal-lg" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">病人信息</h4>
					</div>
					<div class="modal-body">
						<div class="form-horizontal" role="form">
							<div class="row">
								<div class="col-xs-12 col-sm-6 form-group">
									<label for="name" class="col-xs-6 col-sm-5 control-label">姓名</label>
									<div class="col-xs-6 col-sm-6">
										<input type="text" class="form-control" id="name" placeholder="请输入名字">
									</div>
								</div>
								<div class="col-xs-12 col-sm-6 form-group">

									<label for="patientID" class="col-xs-6 col-sm-5  control-label">病人ID</label>
									<div class="col-xs-6 col-sm-6">
										<input type="text" class="form-control" id="patientID" placeholder="请输入病人ID">
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-xs-12 col-sm-6 form-group">
									<label for="sex" class="col-xs-6 col-sm-5 control-label">性别</label>
									<div class="col-xs-6 col-sm-6">
										<select class="form-control">
											<option value=""></option>
											<option value="男">男</option>
											<option value="女">女</option>
										</select>
									</div>

								</div>
								<div class="col-xs-12 col-sm-6 form-group">
									<label for="age" class="col-xs-6 col-sm-5  control-label">年龄</label>
									<div class="col-xs-4 col-sm-3">
										<input type="number" class="form-control" id="age">
									</div>
									<div class="col-xs-2 col-sm-3">
										<select class="form-control">
											<option value=""></option>
											<option value="岁">岁</option>
											<option value="月">月</option>
											<option value="天">天</option>
										</select>
									</div>
								</div>
							</div>

							<div class="row">

								<div class="col-xs-12 col-sm-6 form-group">
									<label class="control-label col-xs-6 col-sm-5">生日</label>
									<div class="col-xs-6 col-sm-6">
										<div for="birthday" class="input-group date" id="birthdayBox">
											<input type="text" class="form-control" id="birthday">
											<span class="input-group-addon" style="cursor: pointer">
                                    			<i class="fa fa-calendar"></i>
                                			</span>
										</div>
									</div>
								</div>

							</div>
						</div>

						<ul class="nav nav-pills">
							<li role="presentation" class="active">
								<a href="#abdomen" aria-controls="abdomen" role="tab" data-toggle="tab">腹部</a>
							</li>
							<li role="presentation">
								<a href="#obstetrics" aria-controls="obstetrics" role="tab" data-toggle="tab">产科</a>
							</li>
							<li role="presentation">
								<a href="#gynecology" aria-controls="gynecology" role="tab" data-toggle="tab">妇科</a>
							</li>
							<li role="presentation">
								<a href="#heart" aria-controls="heart" role="tab" data-toggle="tab">心脏</a>
							</li>
							<li role="presentation">
								<a href="#smallOrgan" aria-controls="smallOrgan" role="tab" data-toggle="tab">小器官</a>
							</li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane fade in active" id="abdomen">
								<div class="form-horizontal" role="form">
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="checkDesc" class="col-xs-4 col-sm-2">检查描述</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="checkDesc" data-bind="value: chekDesc"/>
											</div>
										</div>
									</div>

									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="chiefComplaint" class="col-xs-4 col-sm-2">主诉</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="chiefComplaint" data-bind="value:chiefComplaint"/>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="pastHistory" class="col-xs-4 col-sm-2">既往史</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="pastHistory" data-bind="value: pastHistory"/>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="height" class="col-xs-4 col-sm-2">身高</label>
											<div class="col-xs-6 col-sm-6">
												<input type="text" class="form-control" id="height" />
											</div>
											<div class="col-xs-2 col-sm-2">
												cm
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="weight" class="col-xs-4 col-sm-2">体重</label>
											<div class="col-xs-6 col-sm-6">
												<input type="text" class="form-control" id="weight" />
											</div>
											<div class="col-xs-2 col-sm-2">
												kg
											</div>
										</div>
									</div>
								</div>
							</div>
							<div role="tabpanel" class="tab-pane fade" id="obstetrics">
								<div class="form-horizontal" role="form">
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="checkDesc" class="col-xs-4 col-sm-3">检查描述</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="checkDesc" data-bind="value: chekDesc"/>
											</div>
										</div>
									</div>

									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="chiefComplaint" class="col-xs-4 col-sm-3">主诉</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="chiefComplaint" data-bind="value: chiefComplaint"/>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="pastHistory" class="col-xs-4 col-sm-3">既往史</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="pastHistory" data-bind="value:pastHistory"/>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<div class="col-xs-2 col-sm-3">
												<select name="" id="" class="form-control">
													<option value="LMP">LMP</option>
													<option value="IVF">IVF</option>
													<option value="PRV">PRV</option>
													<option value="BBT">BBT</option>
													<option value="EDD">EDD</option>
												</select>
											</div>
											<div class="col-xs-6 col-sm-4">

												<div class="input-group date">
													<input type="text" class="form-control" id="LMPDate" />
													<span class="input-group-addon" style="cursor: pointer">
														<i class="fa fa-calendar"></i>
													</span>
												</div>

											</div>

										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="" class="col-xs-4 col-sm-3">孕龄(LMP)</label>
											<div class="col-xs-6 col-sm-4">
												<input type="text" class="form-control" id="" />
											</div>

										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="" class="col-xs-4 col-sm-3">预产期(LMP)</label>
											<div class="col-xs-6 col-sm-4">
												<input type="text" class="form-control" id="" />
											</div>

										</div>
									</div>
								</div>

							</div>
							<div role="tabpanel" class="tab-pane fade" id="gynecology">
								<div class="form-horizontal" role="form">
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="checkDesc" class="col-xs-4 col-sm-2">检查描述</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="checkDesc" data-bind="value: chekDesc"/>
											</div>
										</div>
									</div>

									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="chiefComplaint" class="col-xs-4 col-sm-2">主诉</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="chiefComplaint" data-bind="value: chiefComplaint"/>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="pastHistory" class="col-xs-4 col-sm-2">既往史</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="pastHistory" data-bind="value: pastHistory"/>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="lastMenstruation" class="col-xs-4 col-sm-2">末次月经</label>
											<div class="col-xs-8 col-sm-6">
												<div class="input-group date">
													<input type="text" class="form-control" id="lastMenstruation" />
													<span class="input-group-addon" style="cursor: pointer">
														<i class="fa fa-calendar"></i>
													</span>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div role="tabpanel" class="tab-pane fade" id="heart">
								<div class="form-horizontal" role="form">
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="checkDesc" class="col-xs-4 col-sm-2">检查描述</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="checkDesc" data-bind="value:chekDesc"/>
											</div>
										</div>
									</div>

									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="chiefComplaint" class="col-xs-4 col-sm-2">主诉</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="chiefComplaint" data-bind="value: chiefComplaint"/>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="pastHistory" class="col-xs-4 col-sm-2">既往史</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="pastHistory" data-bind="value: pastHistory"/>
											</div>
										</div>
									</div>

									<div class="row">
										<div class="col-xs-12 col-sm-8">
										
											<div class="col-xs-12 col-sm-6 form-group">
												<label class="col-xs-4 col-sm-3">身高</label>
												<div class="col-xs-3 col-sm-5  col-sm-offset-1">
													<input type="text" class="form-control" id="height" />
												</div>
												<div class="col-xs-3 col-sm-1">cm</div>
											</div>
											<div class="col-xs-12 col-sm-6 form-group">
												<label class="col-xs-4 col-sm-3">体重</label>
												<div class="col-xs-3 col-sm-5">
													<input type="text" class="form-control" id="weight" />
												</div>
												<div class="col-xs-3 col-sm-1">kg</div>
											</div>	
											
										</div>
									</div>
									
									<div class="row">
										<div class="col-xs-12 col-sm-8">
										
											<div class="col-xs-12 col-sm-6 form-group">
												<label class="col-xs-4 col-sm-3">心率</label>
												<div class="col-xs-3 col-sm-5  col-sm-offset-1">
													<input type="text" class="form-control" id="" />
												</div>
												<div class="col-xs-3 col-sm-1">Bpm</div>
											</div>
											<div class="col-xs-12 col-sm-6 form-group">
												<label class="col-xs-4 col-sm-3">右房心压</label>
												<div class="col-xs-3 col-sm-5">
													<input type="text" class="form-control" id="" />
												</div>
												<div class="col-xs-3 col-sm-1">mmHg</div>
											</div>	
											
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8">
										
											<div class="col-xs-12 col-sm-6 form-group">
												<label class="col-xs-4 col-sm-3">血压</label>
												<div class="col-xs-3 col-sm-4  col-sm-offset-1">
													<input type="text" class="form-control" id="" />
												</div>
												<div class="col-xs-3 col-sm-4">
													<input type="text" class="form-control" id="" />
												</div>
											</div>
										</div>
									</div>
									
								</div>
							</div>

							<div role="tabpanel" class="tab-pane fade" id="smallOrgan">
								<div class="form-horizontal" role="form">
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="checkDesc" class="col-xs-4 col-sm-3">检查描述</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="checkDesc" data-bind="value: chekDesc"/>
											</div>
										</div>
									</div>

									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="chiefComplaint" class="col-xs-4 col-sm-3">主诉</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="chiefComplaint" data-bind="value: chiefComplaint"/>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-xs-12 col-sm-8 form-group">
											<label for="pastHistory" class="col-xs-4 col-sm-3">既往史</label>
											<div class="col-xs-8 col-sm-8">
												<input type="text" class="form-control" id="pastHistory" data-bind="value: pastHistory"/>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-xs-12 col-sm-12 text-center">
									<button class="btn btn-default btn-lg" type="button" data-bind="click:$root.newPatient">新病人</button>
									<button class="btn btn-default btn-lg" type="button" data-bind="click:$root.newCheck">新检查</button>
									<button class="btn btn-default btn-lg " disabled="disabled" type="button" data-bind="click:$root.cancel">取消检查</button>
									<a href="javascript:void(0)" class="btn btn-default btn-lg">病人列表</a>
								</div>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<div class="row">
							<div class="col-xs-12 col-sm-12 text-center">
								<button type="button" class="btn btn-primary" data-bind="click:$root.sure">确定</button>
								<button type="button" class="btn btn-default" data-dismiss="modal" data-bind="click:$root.close">取消</button>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>
		<!--模态框结束-->
	</body>
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.js"></script>
	<script src="js/jquery.datetimepicker.full.js"></script>
	<script src="js/knockout-3.4.2.js"></script>
	<script src="./layer/layer.js"></script>
	<script src="js/canvas2image.js"></script>
	<!--将元素变成canvas-->
	<script src="js/html2canvas.min.js"></script>
	<script type="text/javascript">
		$(function() {
			let btnGroup1 = $(".btn-group-1");
			let btnGroup2 = $(".btn-group-2");
			
			// 切换按钮
			$(".shift-btn .left").click(function() {
				
				btnGroup1.show();
				btnGroup2.hide();
				$(".shift-btn .right").removeClass("activeBtn");
				$(this).addClass("activeBtn");
			});
			$(".shift-btn .right").click(function() {
				btnGroup1.hide();
				btnGroup2.show();
				$(".shift-btn .left").removeClass("activeBtn");
				$(this).addClass("activeBtn");
				
			});
		
			/*日历控件初始化*/
			// 点击图标按钮---显示日期面板
			$("#birthdayBox>span.input-group-addon").click(function() {
				$('#birthday').datetimepicker("show");
			});
			$('#birthday').datetimepicker({
				format: "Y-m-d",
				hours24: 'true',
				step: 10, //设置时分之间的间隔
				initTime: true,
				autoclose: true, // 选中日期即关闭面板
				minView: "month",
				timepicker: false
			});

			// LMP
			$("#LMPDate").next("span").click(function() {
				$('#LMPDate').datetimepicker("show");
			});
			$("#LMPDate").datetimepicker({
				format: "Y-m-d",
				hours24: 'true',
				step: 10, //设置时分之间的间隔
				initTime: true,
				autoclose: true, // 选中日期即关闭面板
				minView: "month",
				timepicker: false
			});

			// 末次月经
			$("#lastMenstruation").next("span").click(function() {
				$('#lastMenstruation').datetimepicker("show");
			});
			$("#lastMenstruation").datetimepicker({
				format: "Y-m-d",
				hours24: 'true',
				step: 10, //设置时分之间的间隔
				initTime: true,
				autoclose: true, // 选中日期即关闭面板
				minView: "month",
				timepicker: false
			});

			// 监控数据变化
			let vm = new ViewModel();
			ko.applyBindings(vm);
			
			// 控制图像区域高度
			
			controlHeight();
		});
		
		function controlHeight() {
			
			let h = $(window).height()-$(".top-bg").height()-$(".mune-panel").height();
		
			$(".image-online").css({"height":h+"px"});
			
		}
		

		function ViewModel() {
			const self = this;

			self.chekDesc = ko.observable(); // 检查描述
			self.chiefComplaint = ko.observable(); // 主诉
			self.pastHistory = ko.observable(); // 既往史
			self.height = ko.observable(); // 身高
			self.weight = ko.observable(); // 体重
			self.save = function() {
				if($(".leftImage").attr("src")=="") {
					console.log("左边没有图像");
					return;
				}
				if($(".rightImage").attr("src")=="") {
					console.log("右边没有图像");
					return;
				}
				//拿到图片盒子
				html2canvas($(".image-online")[0]).then((canvas)=> {
					//document.body.appendChild(canvas);
					//Canvas2Image.saveAsPNG(canvas,500,500);
					
				
					var image = new Image();
					image.src = canvas.toDataURL("image/png",1.0);
					/*
					 参考链接地址： https://www.cnblogs.com/GoTing/p/6206466.html
					 使用canvas2image.js 会出现图片没有后缀名的情况
					 * */
					var _fixType = function(type) {
					    type = type.toLowerCase().replace(/jpg/i, 'jpeg');
					    var r = type.match(/png|jpeg|bmp|gif/)[0];
					    return 'image/' + r;
					};
					//imgData = image.src.replace(_fixType("png"),'image/octet-stream');
					//console.log(imgData);
					
					var saveFile = function(data, filename){
					    var save_link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');
					    save_link.href = data;
					    save_link.download = filename;
					   
					    var event = document.createEvent('MouseEvents');
					    event.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
					    save_link.dispatchEvent(event);
					};
					var filename = 'saomiao_' + (new Date()).getTime() + '.' + "png";
					// 下载图片
					//saveFile(imgData,filename);
					//console.log(convertCanvasToImage(canvas));
					// 将canvas转变成图片
					var img = convertCanvasToImage(canvas);
					//document.body.appendChild(convertCanvasToImage(canvas));
					$(".right-content")[0].append(img);
				});
				
			}
			
			self.deleteImg = function() {
				
				
			}
			
			
			self.cancel = function() {
				layer.open({
					title: "确认",
					content: "确定要取消检查吗？",
					btn: ["确认","取消"],
					yes: function(index) {
						// 做ajax请求，保存数据
						
						// layer.close(index);
					},
					btn2: function() {
						//alert(false);
					},
					btnAlign: "c",
				});
				
			}
		}
		
		function convertCanvasToImage(canvas) {
			var image = new Image();
			image.src = canvas.toDataURL("image/png",1.0);
			return image;
		}
		
		function isExitImg() {
			let imgContent = $(".right-content");
			// 判断缩略图容器中是否有图片
			if(imgContent.has("img").length === 0) {
				console.log("右侧没有缩略图");
				return false;
			}
			return true;
		}
		/*************************************************************/
			// 获取所有的图片列表
			let imgList = $(".right-content").children();
			console.log(imgList.length);
			if(imgList.length>0) {
				imgList.click((event)=>{
				console.log(222);
				// 获取图片序号
					console.log(event.target);
					$(this).css({borderWight:"1px",borderStyle: "solid",borderColor:"red"});
				});
			}
		/*************************************************************/	
		
		

	
	</script>

</html>